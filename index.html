<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebKit OOB Test - translate()</title>
  <style>
    .test {
      width: 100px;
      height: 100px;
      background: red;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1>WebKit OOB Test</h1>
  <p>Se houver travamento, lentidão ou erro de renderização, pode indicar OOB ou comportamento indefinido.</p>

  <div id="target" class="test"></div>

  <script>
    const target = document.getElementById("target");

    // 1. Transformação malformada (falta parêntese final)
    const malformed1 = "translate(123";

    // 2. Entrada com caracteres excessivos (buffer stress)
    const malformed2 = "translate(" + "9".repeat(100000) + "px)";

    // 3. Entrada truncada com caractere especial
    const malformed3 = "tran\u0001ate(1px)";

    // 4. Entrada válida (controle)
    const valid = "translate(0px)";

    // Teste dinâmico
    const testCases = [malformed1, malformed2, malformed3, valid];

    let i = 0;
    function applyNext() {
      const tf = testCases[i % testCases.length];
      target.style.transform = tf;

      // Força renderização/layout
      const top = target.offsetTop;
      console.log(`Teste #${i}:`, tf, "| offsetTop:", top);

      i++;
      if (i < 100) requestAnimationFrame(applyNext);
    }

    applyNext();
  </script>
</body>
</html>
