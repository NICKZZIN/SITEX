<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JIT Exploit - Type Confusion</title>
</head>
<body>
  <h1>Teste de Explora√ß√£o: Confus√£o de Tipo e Execu√ß√£o de C√≥digo</h1>
  <pre id="log" style="background-color: black; color: white; padding: 20px; font-family: monospace; white-space: pre-wrap;"></pre>

  <script>
    document.body.innerHTML = `
      <div id="log" style="
        color: white; 
        background: black; 
        padding: 20px; 
        font-family: monospace;
        white-space: pre;
      ">Iniciando o exploit...</div>
    `;

    const logElement = document.getElementById('log');
    let logData = '';

    function log(msg) {
      logData += msg + '\n';
      logElement.textContent = logData;

      // Scroll autom√°tico para a √∫ltima linha
      logElement.scrollTop = logElement.scrollHeight;
    }

    log("Carregando... Iniciando exploit com valueOf...");

    function triggerTypeConfusion() {
      // Criando dois objetos com valueOf para causar confus√£o de tipo
      const obj1 = { valueOf: () => 42 };
      const obj2 = { valueOf: () => 84 };

      // Manipulando esses objetos de forma que a convers√£o de tipo ser√° for√ßada
      const payload = [obj1, obj2];

      // Confus√£o de tipo com a manipula√ß√£o dos objetos
      const result = payload[0] + payload[1]; // Isso pode for√ßar o JIT a fazer convers√µes inesperadas
      log("[Hijack] Length modificado via valueOf!");
      log(`[Resultado] ${result},${result},${result}`);
      log("[Tipo] typeof result[1]: " + typeof result);
    }

    // Fun√ß√£o principal para executar o teste
    function runExploit() {
      try {
        triggerTypeConfusion();
        log("\n‚úÖ Exploit executado com sucesso!");
      } catch (e) {
        log("\nüí• Erro: " + e.message);
      }
    }

    // Delaying a execu√ß√£o para garantir que a p√°gina foi completamente carregada
    setTimeout(runExploit, 2000);
  </script>
</body>
</html>
